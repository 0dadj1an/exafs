{% extends 'layouts/default.j2' %}
{% from 'macros.j2' import build_ip_tbody, build_rtbh_tbody, build_rules_thead %}


{% block title %}Flowspec{% endblock %}
{% block content %}

    {% include 'pages/submenu_dashboard.j2' %}



    <h2>{{ rstate|capitalize }} {{ table_title }} that you can modify</h2>
    <table class="table table-hover ip-table">
    {{ build_rules_thead(rules_columns, rtype, rstate, sort_key, sort_order) }}
    {% if rtype_int == 1 %}
        {{ build_rtbh_tbody(rules_editable, today, rtype_int) }}
    {% else %}
        {{ build_ip_tbody(rules_editable, today, rtype_int) }}
    {% endif %}
    </table>


    <h2>{{ rstate|capitalize }}  {{ table_title }} that are read-only for you</h2>
    {% if rules_visible %}

        <p>Those rules somehow including your network ranges. However, they have privileged / admin only action. Therefore you can not modify their expiration time.</p>
        <table class="table table-hover ip-table">
        {{ build_rules_thead(rules_columns, rtype, rstate, sort_key, sort_order) }}
        {% if rtype_int == 1 %}
            {{ build_rtbh_tbody(rules_editable, today, rtype_int, False) }}
        {% else %}
            {{ build_ip_tbody(rules_visible, today, rtype_int, False) }}
        {% endif %}
        </table>
    {% else %}
        <p>There are no ReadOnly rules that including your network ranges.</p
    {% endif %}


{% endblock %}